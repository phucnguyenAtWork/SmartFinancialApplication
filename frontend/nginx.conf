server {
	listen 80;
	server_name _;
	root /usr/share/nginx/html;
	index index.html;

	# Gzip compression
	gzip on;
	gzip_types text/css application/javascript application/json image/svg+xml;
	gzip_min_length 1024;

	# Cache busting: hashed asset files (e.g. main.abc123.js) get long cache
	location ~* \.(?:js|css|woff2?|ttf|otf|eot)$ {
		add_header Cache-Control "public, max-age=31536000, immutable";
		try_files $uri =404;
	}

	location ~* \.(?:png|jpe?g|gif|svg|webp|ico)$ {
		add_header Cache-Control "public, max-age=31536000, immutable";
		try_files $uri =404;
	}

	# Do not cache HTML entrypoint
	location = /index.html {
		add_header Cache-Control "no-cache";
		try_files $uri =404;
	}

	# SPA fallback: any other route serve index.html
	location / {
		try_files $uri $uri/ /index.html;
	}

	# Basic security headers
	add_header X-Content-Type-Options nosniff;
	add_header X-Frame-Options SAMEORIGIN;
	add_header Referrer-Policy no-referrer-when-downgrade;
}
